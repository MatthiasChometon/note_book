{"version":3,"sources":["../../src/services/authService.js"],"names":["require","config","jwt","AuthService","authenticateToken","req","res","next","authHeader","headers","token","split","sendStatus","verify","process","env","ACCESS_TOKEN_SECRET","err","user","generateAccessToken","sign","expiresIn"],"mappings":";;;;;AAAAA,QAAQ,QAAR,EAAkBC,MAAlB;AACA,MAAMC,MAAMF,QAAQ,cAAR,CAAZ;AACO,MAAMG,WAAN,CAAkB;AACrBC,sBAAkBC,GAAlB,EAAuBC,GAAvB,EAA4BC,IAA5B,EAAkC;AAC9B,cAAMC,aAAaH,IAAII,OAAJ,CAAY,eAAZ,CAAnB;AACA,cAAMC,QAAQF,cAAcA,WAAWG,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAA5B;AACA,YAAID,SAAS,IAAb,EAAmB,OAAOJ,IAAIM,UAAJ,CAAe,GAAf,CAAP;;AAEnBV,YAAIW,MAAJ,CAAWH,KAAX,EAAkBI,QAAQC,GAAR,CAAYC,mBAA9B,EAAmD,CAACC,GAAD,EAAMC,IAAN,KAAe;AAC9D,gBAAID,GAAJ,EAAS,OAAOX,IAAIM,UAAJ,CAAe,GAAf,CAAP;AACTP,gBAAIa,IAAJ,GAAWA,IAAX;AACAX;AACH,SAJD;AAKH;;AAEDY,wBAAoBD,IAApB,EAA0B;AACtB,eAAOhB,IAAIkB,IAAJ,CAASF,IAAT,EAAeJ,QAAQC,GAAR,CAAYC,mBAA3B,EAAgD,EAAEK,WAAW,KAAb,EAAhD,CAAP;AACH;AAfoB;QAAZlB,W,GAAAA,W","file":"authService.js","sourcesContent":["require('dotenv').config()\r\nconst jwt = require('jsonwebtoken')\r\nexport class AuthService {\r\n    authenticateToken(req, res, next) {\r\n        const authHeader = req.headers['authorization']\r\n        const token = authHeader && authHeader.split(' ')[1]\r\n        if (token == null) return res.sendStatus(401)\r\n\r\n        jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) => {\r\n            if (err) return res.sendStatus(403)\r\n            req.user = user\r\n            next()\r\n        })\r\n    }\r\n\r\n    generateAccessToken(user) {\r\n        return jwt.sign(user, process.env.ACCESS_TOKEN_SECRET, { expiresIn: '15m' })\r\n    }\r\n}"]}